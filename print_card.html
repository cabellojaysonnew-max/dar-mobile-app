<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Women's Month Commemorative Cards</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">

<style>
:root{
    --purple:#5a2ca0;
    --deep-purple:#2b0f63;
    --pink:#ff6ec7;
    --gold:#ffd54f;
    --lavender:#d9c6ff;
}

/* BODY */
body{
    font-family:'Montserrat',sans-serif;
    margin:0;
    background:#ececec;
}

/* CONTROLS */
.controls{
    padding:20px;
    text-align:center;
    background:white;
}

button{
    background:linear-gradient(45deg,var(--purple),var(--pink));
    color:white;
    border:none;
    padding:12px 26px;
    font-weight:700;
    cursor:pointer;
}

/* PRINT SETTINGS */
@media print{
    body{background:none;margin:0;}
    .controls{display:none;}

    @page{
        size:A4;
        margin:8mm;
    }
}

/* PAGE */
.page{
    width:210mm;
    min-height:297mm;
    background:white;
    display:flex;
    flex-wrap:wrap;
    gap:4mm;
    padding:8mm;
    margin:0 auto;
    box-sizing:border-box;
    page-break-after:always;
}

/* CARD */
.card{
    width:85.6mm;
    height:54mm;
    border:1.5px solid var(--deep-purple);
    border-radius:0; /* SQUARE CORNER */
    background:
        linear-gradient(135deg,
            var(--lavender),
            #f3e8ff,
            #ffd6f2);
    display:flex;
    position:relative;
    overflow:hidden;
    box-sizing:border-box;

    -webkit-print-color-adjust:exact;
    print-color-adjust:exact;
}

/* COLORFUL STRIPE */
.card::before{
    content:"";
    position:absolute;
    left:0;
    top:0;
    bottom:0;
    width:13mm;
    background:linear-gradient(
        180deg,
        var(--deep-purple),
        var(--purple),
        var(--pink)
    );
}

/* WM WATERMARK */
.card::after{
    content:"";
    position:absolute;
    right:4mm;
    bottom:4mm;
    width:32mm;
    height:32mm;
    background:url('wm_logo.png') no-repeat center;
    background-size:contain;
    opacity:0.18;
}

/* 2026 BADGE (FUN STYLE) */
.year{
    position:absolute;
    top:5px;
    right:6px;
    background:linear-gradient(45deg,var(--gold),#fff2a8);
    color:var(--deep-purple);
    font-weight:900;
    font-size:12px;
    padding:3px 8px;
    border:1px solid var(--deep-purple);
}

/* LOGOS */
.logo-area{
    width:32%;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    padding-left:7mm;
    gap:4px;
}

.logo-area img{
    width:36px;
    height:36px;
    object-fit:contain;
}

/* INFO */
.info-area{
    width:68%;
    padding:8px 10px 8px 6px;
    display:flex;
    flex-direction:column;
    justify-content:center;
}

/* TEXT */
.event-name{
    font-size:10px;
    font-weight:800;
    color:var(--deep-purple);
    text-transform:uppercase;
    letter-spacing:1px;
}

.pass-title{
    font-size:16px;
    font-weight:900;
    color:var(--purple);
    margin:2px 0 3px;
}

.comm{
    font-size:9px;
    color:#4b3c74;
    margin-bottom:4px;
}

/* NAME */
.name{
    font-size:13px;
    font-weight:900;
    color:var(--deep-purple);
    text-transform:uppercase;
    letter-spacing:.5px;
}

/* DETAILS */
.detail{
    font-size:11px;
    color:#2e2e2e;
}
</style>
</head>

<body onload="loadData()">

<div class="controls">
<button onclick="window.print()">PRINT COMMEMORATIVE CARDS</button>
<p id="status" style="font-size:12px;margin-top:5px;">Loading...</p>
</div>

<div id="container"></div>

<script>
const scriptURL =
'https://script.google.com/macros/s/AKfycbwIRpvQezzXayJ8N3S_gpvz6yZxtLTmZp6RXrN-u7w7M4UfzqVfvLz-DPIpqNTKedK17Q/exec';

async function loadData(){
    try{
        const res = await fetch(`${scriptURL}?action=getBookings`);
        const data = await res.json();
        document.getElementById('status').innerText =
            `Loaded ${data.length} cards.`;
        render(data);
    }catch(e){
        document.getElementById('status').innerText="Error loading data.";
    }
}

function render(data){

    const container=document.getElementById('container');

    let page=document.createElement('div');
    page.className='page';
    container.appendChild(page);

    const perPage=10;
    let count=0;

    data.forEach(item=>{

        if(count>=perPage){
            page=document.createElement('div');
            page.className='page';
            container.appendChild(page);
            count=0;
        }

        const card=document.createElement('div');
        card.className='card';

        card.innerHTML=`
            <div class="year">2026</div>

            <div class="logo-area">
                <img src="dar-logo.png" onerror="this.style.display='none'">
                <img src="gad-logo.png" onerror="this.style.display='none'">
            </div>

            <div class="info-area">
                <div class="event-name">Women's Month</div>
                <div class="pass-title">SERVICE CARD</div>
                <div class="comm">Commemorative Edition</div>

                <div class="name">${item.name}</div>
                <div class="detail">${item.service}</div>
                <div class="detail">${item.time} | ${item.provider}</div>
            </div>
        `;

        page.appendChild(card);
        count++;
    });
}
</script>

</body>
</html>
