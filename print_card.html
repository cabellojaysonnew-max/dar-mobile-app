<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Service Cards (1x2 inch)</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --purple: #3b2164; --gold: #f9e18b; }
        body { font-family: 'Montserrat', sans-serif; margin: 0; background: #eee; }
        
        .controls { padding: 20px; text-align: center; background: white; margin-bottom: 20px; }
        button { background: var(--purple); color: var(--gold); border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; }

        @media print {
            body { background: none; margin: 0; }
            .controls { display: none; }
            @page { size: A4; margin: 10mm; }
        }

        .page {
            width: 210mm;
            min-height: 297mm;
            background: white;
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
            gap: 2mm;
            padding: 10mm;
            margin: 0 auto;
            box-sizing: border-box;
            page-break-after: always;
        }

        /* 1 inch height x 2 inches width */
        .card {
            width: 2in;
            height: 1in;
            background: var(--purple);
            color: white;
            border: 1px solid #000;
            display: flex;
            align-items: center;
            padding: 5px;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }

        .logo-area {
            width: 30%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .logo-area img { width: 40px; height: 40px; object-fit: contain; }

        .info-area {
            width: 70%;
            padding-left: 5px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .event-name { font-size: 6px; color: var(--gold); letter-spacing: 1px; text-transform: uppercase; }
        .pass-title { font-size: 9px; font-weight: 900; line-height: 1; margin: 2px 0; }
        .detail { font-size: 5px; color: #ddd; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .highlight { color: var(--gold); font-weight: bold; }

    </style>
</head>
<body onload="loadData()">

    <div class="controls">
        <button onclick="window.print()">PRINT CARDS</button>
        <p id="status" style="font-size: 12px; margin-top: 5px;">Loading...</p>
    </div>

    <div id="container"></div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwIRpvQezzXayJ8N3S_gpvz6yZxtLTmZp6RXrN-u7w7M4UfzqVfvLz-DPIpqNTKedK17Q/exec';

        async function loadData() {
            try {
                const res = await fetch(`${scriptURL}?action=getBookings`);
                const data = await res.json();
                document.getElementById('status').innerText = `Loaded ${data.length} cards.`;
                render(data);
            } catch (e) {
                document.getElementById('status').innerText = "Error loading data.";
            }
        }

        function render(data) {
            const container = document.getElementById('container');
            let page = document.createElement('div');
            page.className = 'page';
            container.appendChild(page);

            // A4 fits approx 27 cards
            let count = 0;
            const perPage = 27; 

            data.forEach(item => {
                if (count >= perPage) {
                    page = document.createElement('div');
                    page.className = 'page';
                    container.appendChild(page);
                    count = 0;
                }

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="logo-area">
                        <img src="dar-logo.png" onerror="this.style.display='none'">
                    </div>
                    <div class="info-area">
                        <div class="event-name">Women's Month 2026</div>
                        <div class="pass-title">SERVICE PASS</div>
                        <div class="detail highlight">${item.name}</div>
                        <div class="detail">${item.service}</div>
                        <div class="detail">${item.time} | ${item.provider}</div>
                    </div>
                `;
                page.appendChild(card);
                count++;
            });
        }
    </script>
</body>
</html>
