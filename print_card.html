<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Women's Month Commemorative Cards</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">

<style>
:root{
    --purple:#3b2164;
    --deep-purple:#2a1649;
    --light-purple:#f4edff;
    --gold:#d4af37;
}

body{
    font-family:'Montserrat',sans-serif;
    margin:0;
    background:#eee;
}

/* CONTROLS */
.controls{
    padding:20px;
    text-align:center;
    background:white;
    margin-bottom:20px;
}

button{
    background:var(--purple);
    color:white;
    border:none;
    padding:10px 24px;
    font-weight:700;
    cursor:pointer;
    border-radius:6px;
}

/* PRINT SETTINGS */
@media print{
    body{background:none;margin:0;}
    .controls{display:none;}

    @page{
        size:A4;
        margin:8mm;
    }
}

/* PAGE */
.page{
    width:210mm;
    min-height:297mm;
    background:white;
    display:flex;
    flex-wrap:wrap;
    gap:4mm;
    padding:8mm;
    margin:0 auto;
    box-sizing:border-box;
    page-break-after:always;
}

/* CARD */
.card{
    width:85.6mm;
    height:54mm;
    border-radius:8px;
    border:1px solid var(--purple);
    background:linear-gradient(135deg,var(--light-purple),#ffffff);
    display:flex;
    position:relative;
    overflow:hidden;
    box-sizing:border-box;
}

/* WOMEN'S MONTH WATERMARK */
.card::after{
    content:"";
    position:absolute;
    right:4mm;
    bottom:4mm;
    width:28mm;
    height:28mm;
    background:url('wm_logo.png') no-repeat center;
    background-size:contain;
    opacity:0.12;
    pointer-events:none;
}

/* LEFT PURPLE STRIPE */
.card::before{
    content:"";
    position:absolute;
    left:0;
    top:0;
    bottom:0;
    width:11mm;
    background:linear-gradient(var(--deep-purple),var(--purple));
}

/* YEAR BADGE */
.year{
    position:absolute;
    top:5px;
    right:8px;
    font-size:10px;
    font-weight:900;
    color:var(--gold);
}

/* LOGO AREA */
.logo-area{
    width:32%;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    padding-left:6mm;
    gap:3px;
}

.logo-area img{
    width:36px;
    height:36px;
    object-fit:contain;
}

/* INFO AREA */
.info-area{
    width:68%;
    padding:8px 10px 8px 6px;
    display:flex;
    flex-direction:column;
    justify-content:center;
}

/* TEXT STYLES */
.event-name{
    font-size:10px;
    font-weight:700;
    letter-spacing:1px;
    color:var(--purple);
    text-transform:uppercase;
}

.pass-title{
    font-size:15px;
    font-weight:900;
    color:var(--gold);
    margin:2px 0 3px;
}

.comm{
    font-size:8px;
    color:#666;
    margin-bottom:4px;
}

/* NAME â€” ALL CAPS */
.name{
    font-size:12px;
    font-weight:900;
    color:var(--deep-purple);
    text-transform:uppercase;
    letter-spacing:.5px;
}

.detail{
    font-size:11px;
    color:#333;
    line-height:1.2;
}
</style>
</head>

<body onload="loadData()">

<div class="controls">
<button onclick="window.print()">PRINT COMMEMORATIVE CARDS</button>
<p id="status" style="font-size:12px;margin-top:5px;">Loading...</p>
</div>

<div id="container"></div>

<script>
const scriptURL='https://script.google.com/macros/s/AKfycbwIRpvQezzXayJ8N3S_gpvz6yZxtLTmZp6RXrN-u7w7M4UfzqVfvLz-DPIpqNTKedK17Q/exec';

async function loadData(){
    try{
        const res=await fetch(`${scriptURL}?action=getBookings`);
        const data=await res.json();
        document.getElementById('status').innerText=`Loaded ${data.length} cards.`;
        render(data);
    }catch(e){
        document.getElementById('status').innerText="Error loading data.";
    }
}

function render(data){

    const container=document.getElementById('container');

    let page=document.createElement('div');
    page.className='page';
    container.appendChild(page);

    const perPage=10;
    let count=0;

    data.forEach(item=>{

        if(count>=perPage){
            page=document.createElement('div');
            page.className='page';
            container.appendChild(page);
            count=0;
        }

        const card=document.createElement('div');
        card.className='card';

        card.innerHTML=`
            <div class="year">2026</div>

            <div class="logo-area">
                <img src="dar-logo.png" onerror="this.style.display='none'">
                <img src="gad_logo.png" onerror="this.style.display='none'">
            </div>

            <div class="info-area">
                <div class="event-name">Women's Month</div>
                <div class="pass-title">SERVICE CARD</div>
                <div class="comm">Commemorative Edition</div>

                <div class="name">${item.name}</div>
                <div class="detail">${item.service}</div>
                <div class="detail">${item.time} | ${item.provider}</div>
            </div>
        `;

        page.appendChild(card);
        count++;
    });
}
</script>

</body>
</html>
