<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JuanaHELP | DAR Camarines Sur 1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #3b2164; color: white; overflow-x: hidden; }
        .glass-card { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .accent-yellow { color: #f9e18b; }
        .progress-bg { background: rgba(0,0,0,0.3); height: 12px; border-radius: 6px; position: relative; overflow: hidden; }
        .progress-fill { background: linear-gradient(90deg, #f9e18b, #ffcc00); height: 100%; border-radius: 6px; transition: width 1.5s cubic-bezier(0.1, 0.5, 0.5, 1); width: 0%; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-12 px-4" onload="init()">

    <header class="text-center mb-12">
        <div class="flex flex-col items-center">
            <div class="flex items-baseline space-x-2">
                <span class="text-5xl md:text-6xl font-black italic tracking-tighter text-white">Juana</span>
                <span class="text-4xl md:text-5xl font-black tracking-tighter bg-white text-purple-900 px-3 py-1 rounded-xl shadow-2xl">HELP</span>
            </div>
            <div class="mt-4 flex items-center space-x-2">
                <div class="h-[2px] w-8 bg-pink-400"></div>
                <p class="text-[10px] md:text-xs uppercase tracking-[0.4em] font-black text-pink-300">Women helping children in crisis</p>
                <div class="h-[2px] w-8 bg-pink-400"></div>
            </div>
        </div>
    </header>

    <main class="w-full max-w-lg">
        <div class="glass-card rounded-[2rem] p-8 shadow-2xl relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-yellow-400 to-transparent opacity-50"></div>
            
            <div class="flex items-center justify-between mb-8">
                <h3 class="text-sm font-black uppercase tracking-widest accent-yellow flex items-center">
                    <i data-lucide="activity" class="mr-2 w-4 h-4"></i> Real-Time Pledge Monitor
                </h3>
                <span id="liveIndicator" class="text-[10px] font-bold opacity-40 uppercase tracking-tighter flex items-center">
                    <span class="w-2 h-2 bg-green-500 rounded-full mr-1 animate-pulse"></span> Live
                </span>
            </div>
            
            <div id="pledgeList" class="space-y-7">
                <div class="text-center py-10 opacity-50 italic text-sm">Initializing connection...</div>
            </div>

            <div class="mt-10 pt-6 border-t border-white/10 flex justify-between items-center opacity-40">
                <p class="text-[9px] font-bold uppercase tracking-widest italic">DAR Camarines Sur 1</p>
                <p class="text-[9px] font-bold uppercase tracking-widest italic" id="currentTime"></p>
            </div>
        </div>
    </main>

    <script>
        lucide.createIcons();

        // YOUR UPDATED SCRIPT URL
        const scriptURL = 'https://script.google.com/macros/s/11AKfycbyk1-ptlDiEk-SrVS5KHkPgRp7H-evRPajb6L1IJkJvLnznSH9YsWKvAuYbm5lbscXc1A/exec';

        const config = [
            { id: 'hygiene', label: 'Personal Hygiene', goal: 100, unit: 'sets' },
            { id: 'school', label: 'School Supplies', goal: 100, unit: 'packs' },
            { id: 'slippers', label: 'Slippers', goal: 100, unit: 'pairs' },
            { id: 'undergarments', label: 'Undergarments', goal: 150, unit: 'pcs' },
            { id: 'biscuits', label: 'Biscuits', goal: 200, unit: 'packs' },
            { id: 'rice', label: 'Rice', goal: 500, unit: 'kg' }, // RICE IN KG
            { id: 'milk', label: 'Milk', goal: 200, unit: 'pcs' },
            { id: 'soap', label: 'Laundry Soap', goal: 100, unit: 'pcs' }
        ];

        function updateTime() {
            const now = new Date();
            // Strict 12-hour format per instructions
            document.getElementById('currentTime').innerText = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });
        }

        async function init() {
            updateTime();
            renderList({}); 
            fetchData();
            setInterval(fetchData, 30000); // Auto-refresh 30s
            setInterval(updateTime, 1000);
        }

        async function fetchData() {
            try {
                const response = await fetch(scriptURL);
                if (!response.ok) throw new Error('Connection Error');
                const data = await response.json();
                renderList(data);
            } catch (e) {
                console.error("Connection failed. Check Google Script permissions.");
            }
        }

        function renderList(apiData) {
            const list = document.getElementById('pledgeList');
            list.innerHTML = '';

            config.forEach(item => {
                const current = apiData[item.id] || 0;
                const percent = Math.min((current / item.goal) * 100, 100);

                list.innerHTML += `
                    <div class="group">
                        <div class="flex justify-between items-end mb-2">
                            <div>
                                <span class="block text-[10px] font-black uppercase tracking-wider text-pink-300 mb-1 opacity-80">${item.label}</span>
                                <span class="text-xl font-black tabular-nums">${current.toLocaleString()} <span class="text-[10px] opacity-40 font-bold uppercase">${item.unit}</span></span>
                            </div>
                            <div class="text-right">
                                <span class="text-[10px] font-bold opacity-30 italic">Target: ${item.goal} ${item.unit}</span>
                            </div>
                        </div>
                        <div class="progress-bg">
                            <div class="progress-fill" style="width: ${percent}%"></div>
                        </div>
                    </div>
                `;
            });
        }
    </script>
</body>
</html>
